<?xml version="1.0" encoding="UTF-8"?>
<x:description xmlns:x="http://www.daisy.org/ns/xprocspec"
               xmlns:sbs="http://www.sbs.ch"
               xmlns:brl="http://www.daisy.org/z3986/2009/braille/"
               script="http://www.sbs.ch/pipeline/modules/braille/dtbook-to-pef.xpl">
  
  <x:scenario label="list-numbering">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <list type="ol">
                    <li>Bla bla bla bla</li>
                    <li>Bla bla bla bla</li>
                    <li>Bla bla bla bla</li>
                    <li>Bla bla bla bla</li>
                    <li>Bla bla bla bla</li>
                  </list>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/list-numbering/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/list-numbering/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠼⠂⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠼⠆⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠼⠒⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠼⠲⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠼⠢⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
		  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠒⠒⠒⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!--
      I had to make this pending. Christian please have a look, I think it broke after the latest
      CSS update.
  -->
  <x:scenario label="margin-top" pending="true">
    <x:documentation>
      Test that empty lines before headings are skipped at the top of a page.
    </x:documentation>
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <h1>Level 1</h1>
                  <level2>
                    <h1>Level 2</h1>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                  </level2>
                  <level2>
                    <h1>Level 2</h1>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                  </level2>
                  <level2>
                    <h1>Level 2</h1>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                  </level2>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/margin-top/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/margin-top/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta  xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠁</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠒⠒⠒⠀⠇⠑⠧⠑⠇⠀⠼⠁⠀⠀⠀⠀⠀⠀⠀</row>
                </page>
                <page>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="preceding-separator">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <p> Bla bla bla </p>
                  <p class="precedingseparator"> Bla bla bla </p>
                  <p> Bla bla bla </p>
                  <p class="precedingseparator noindent"> Bla bla bla </p>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/preceding-separator/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/preceding-separator/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒</row>
                  <row/>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒</row>
                  <row/>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠒⠒⠒⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="toc">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <frontmatter>
                <level1>
                  <h1>Title</h1>
                </level1>
              </frontmatter>
              <bodymatter>
                <level1>
                  <pagenum id="page-1" page="normal">1</pagenum>
                  <h1>Level 1</h1>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <p>Bla bla bla</p>
                  <level2>
                    <pagenum id="page-2" page="normal">2</pagenum>
                    <h2>Level 2</h2>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <pagenum id="page-3" page="normal">3</pagenum>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                  </level2>
                  <level2>
                    <h2>Level 2</h2>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <pagenum id="page-4" page="normal">4</pagenum>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                  </level2>
                  <level2>
                    <h2>Level 2</h2>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <pagenum id="page-2" page="normal">5</pagenum>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                    <p>Bla bla bla</p>
                  </level2>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="toc-depth" select="2"/>
      <x:param port="parameters" name="generate-titlepage" select="false()"/>
    </x:call>
    <x:scenario label="single-volume">
      <x:call>
        <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/toc/single-volume/')"/>
        <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
      </x:call>
      <x:context label="result">
        <x:document type="file" base-uri="temp-dir" href="output-dir/toc/single-volume/test_dtbook-to-pef.pef"/>
      </x:context>
      <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
        <x:document type="inline">
          <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
            <head>
              <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
                <dc:format>application/x-pef+xml</dc:format>
                <dc:language>de</dc:language>
              </meta>
            </head>
            <body>
              <volume cols="28" rows="28" rowgap="0" duplex="true">
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠞⠊⠞⠇⠑</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎</row>
                    <row>⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠁⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠂⠁</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠆⠁</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠒⠃</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠲⠉</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎⠀⠀⠀⠀⠘⠊</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠁</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠸⠼⠁⠆⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠁⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                  </page>
                  <page>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  </page>
                  <page>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠸⠼⠃⠢⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠀⠀⠀⠀⠀⠀⠼⠉</row>
                  </page>
                </section>
              </volume>
            </body>
          </pef>
        </x:document>
      </x:expect>
    </x:scenario>
    <x:scenario label="multiple-volumes">
      <x:call>
        <x:option name="maximum-number-of-sheets" select="3"/>
        <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/toc/multiple-volumes/')"/>
        <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
      </x:call>
      <x:context label="result">
        <x:document type="file" base-uri="temp-dir" href="output-dir/toc/multiple-volumes/test_dtbook-to-pef.pef"/>
      </x:context>
      <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
        <x:document type="inline">
          <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
            <head>
              <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
                <dc:format>application/x-pef+xml</dc:format>
                <dc:language>de</dc:language>
              </meta>
            </head>
            <body>
              <volume cols="28" rows="28" rowgap="0" duplex="true">
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠞⠊⠞⠇⠑</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎</row>
                    <row>⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠑⠗⠎⠞⠑⠗⠀⠃⠁⠝⠙</row>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠁⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠂⠁</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠆⠁</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠒⠃</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠵⠺⠑⠊⠞⠑⠗⠀⠃⠁⠝⠙</row>
                    <row/>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠲⠉</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎⠀⠀⠀⠀⠘⠊</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠁</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠸⠼⠁⠆⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠁⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                  </page>
                  <page>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  </page>
                </section>
              </volume>
              <volume cols="28" rows="28" rowgap="0" duplex="true">
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎</row>
                    <row>⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠵⠺⠑⠊⠞⠑⠗⠀⠃⠁⠝⠙</row>
                    <row/>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠲⠉</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎⠀⠀⠀⠀⠘⠊</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠸⠼⠙⠢⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠀⠀⠀⠀⠀⠀⠼⠉</row>
                  </page>
                </section>
              </volume>
            </body>
          </pef>
        </x:document>
      </x:expect>
    </x:scenario>
    <x:scenario label="grade-2">
      <x:call>
        <x:option name="contraction-grade" select="2"/>
        <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/toc/grade-2/')"/>
        <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
      </x:call>
      <x:context label="result">
        <x:document type="file" base-uri="temp-dir" href="output-dir/toc/grade-2/test_dtbook-to-pef.pef"/>
      </x:context>
      <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
        <x:document type="inline">
          <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
            <head>
              <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
                <dc:format>application/x-pef+xml</dc:format>
                <dc:language>de</dc:language>
              </meta>
            </head>
            <body>
              <volume cols="28" rows="28" rowgap="0" duplex="true">
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠞⠊⠞⠇⠑</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠔⠓⠒⠞⠎⠧⠻⠵⠩⠹⠭</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠇⠑⠧⠽⠀⠼⠁⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠂⠁</row>
                    <row>⠀⠀⠇⠑⠧⠽⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠆⠁</row>
                    <row>⠀⠀⠇⠑⠧⠽⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠒⠃</row>
                    <row>⠀⠀⠇⠑⠧⠽⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠲⠉</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠔⠓⠒⠞⠎⠧⠻⠵⠩⠹⠭⠀⠀⠀⠀⠀⠀⠀⠘⠊</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠽⠀⠼⠁</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠽⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠸⠼⠁⠆⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠽⠀⠼⠁⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                  </page>
                  <page>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠽⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  </page>
                  <page>
                    <row>⠇⠑⠧⠽⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠸⠼⠃⠢⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠽⠀⠼⠃⠀⠀⠀⠀⠀⠀⠀⠼⠉</row>
                  </page>
                </section>
              </volume>
            </body>
          </pef>
        </x:document>
      </x:expect>
    </x:scenario>
    <x:scenario label="no-print-page-numbers">
      <x:call>
        <x:option name="show-print-page-numbers" select="false()"/>
        <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/toc/no-print-page-numbers/')"/>
        <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
      </x:call>
      <x:context label="result">
        <x:document type="file" base-uri="temp-dir" href="output-dir/toc/no-print-page-numbers/test_dtbook-to-pef.pef"/>
      </x:context>
      <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
        <x:document type="inline">
          <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
            <head>
              <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
                <dc:format>application/x-pef+xml</dc:format>
                <dc:language>de</dc:language>
              </meta>
            </head>
            <body>
              <volume cols="28" rows="28" rowgap="0" duplex="true">
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠞⠊⠞⠇⠑</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎</row>
                    <row>⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠁⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠁</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠁</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠃</row>
                    <row>⠀⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠉</row>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎⠀⠀⠀⠀⠘⠊</row>
                  </page>
                </section>
                <section>
                  <page>
                    <row/>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠑⠧⠑⠇⠀⠼⠁</row>
                    <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤</row>
                    <row/>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠒⠒⠒⠀⠇⠑⠧⠑⠇⠀⠼⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                  </page>
                  <page>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  </page>
                  <page>
                    <row>⠇⠑⠧⠑⠇⠀⠼⠃</row>
                    <row>⠒⠒⠒⠒⠒⠒⠒⠒</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row/>
                    <row>⠒⠒⠒⠀⠇⠑⠧⠑⠇⠀⠼⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠉</row>
                  </page>
                </section>
              </volume>
            </body>
          </pef>
        </x:document>
      </x:expect>
    </x:scenario>
  </x:scenario>
  
  <x:scenario label="toc-line">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <pagenum id="page-10" page="normal">10</pagenum>
                  <h1>1 Originalüberschrift<brl:toc-line>1
                  toc-Eintrag</brl:toc-line></h1>
                  <p>10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
                  10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10</p>
                </level1>
                <level1>
                  <pagenum id="page-11" page="normal">11</pagenum>
                  <h1>2 Originalüberschrift<brl:toc-line>2
                  toc-Eintrag</brl:toc-line></h1>
                  <p>11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11
                  11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11</p>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="toc-depth" select="2"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:param port="parameters" name="generate-titlepage" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/toc-line/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/toc-line/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎</row>
                  <row>⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠼⠁⠀⠞⠕⠉⠤⠑⠊⠝⠞⠗⠁⠛⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠁</row>
                  <row>⠼⠃⠀⠞⠕⠉⠤⠑⠊⠝⠞⠗⠁⠛⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠃</row>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎⠀⠀⠀⠀⠘⠊</row>
                </page>
              </section>
              <section>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                  <row>⠀⠀⠀⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞</row>
                  <row>⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠒⠒⠒⠀⠼⠁⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞⠀⠀</row>
                </page>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠃</row>
                  <row>⠀⠀⠀⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞</row>
                  <row>⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="running-line">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <pagenum id="page-10" page="normal">10</pagenum>
                  <h1>1 Originalüberschrift<brl:running-line>1 run-Eintrag</brl:running-line></h1>
                  <p>10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
                  10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10</p>
                </level1>
                <level1>
                  <pagenum id="page-11" page="normal">11</pagenum>
                  <h1>2 Originalüberschrift<brl:running-line>2 run-Eintrag</brl:running-line></h1>
                  <p>11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11
                  11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11</p>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="toc-depth" select="2"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:param port="parameters" name="generate-titlepage" select="false()"/>
      <x:option name="include-brf" select="true()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/running-line/')"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/running-line/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/running-line/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎</row>
                  <row>⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠼⠁⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞⠀⠄⠄⠀⠼⠁</row>
                  <row>⠼⠃⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞⠀⠄⠄⠀⠼⠃</row>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎⠀⠀⠀⠀⠘⠊</row>
                </page>
              </section>
              <section>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                  <row>⠀⠀⠀⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞</row>
                  <row>⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠒⠒⠒⠀⠼⠁⠀⠗⠥⠝⠤⠑⠊⠝⠞⠗⠁⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀</row>
                </page>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠃</row>
                  <row>⠀⠀⠀⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞</row>
                  <row>⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="toc-line-and-running-line">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <pagenum id="page-10" page="normal">10</pagenum>
                  <h1>1 Originalüberschrift<brl:running-line>1 run-Eintrag</brl:running-line><brl:toc-line>1
                  toc-Eintrag</brl:toc-line></h1>
                  <p>10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
                  10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10</p>
                </level1>
                <level1>
                  <pagenum id="page-11" page="normal">11</pagenum>
                  <h1>2 Originalüberschrift<brl:running-line>2 run-Eintrag</brl:running-line><brl:toc-line>2
                  toc-Eintrag</brl:toc-line></h1>
                  <p>11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11
                  11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11</p>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="toc-depth" select="2"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:param port="parameters" name="generate-titlepage" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/toc-line-and-running-line/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/toc-line-and-running-line/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎</row>
                  <row>⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠼⠁⠀⠞⠕⠉⠤⠑⠊⠝⠞⠗⠁⠛⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠁</row>
                  <row>⠼⠃⠀⠞⠕⠉⠤⠑⠊⠝⠞⠗⠁⠛⠀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠀⠼⠃</row>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠊⠝⠓⠁⠇⠞⠎⠧⠑⠗⠵⠑⠊⠉⠓⠝⠊⠎⠀⠀⠀⠀⠘⠊</row>
                </page>
              </section>
              <section>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                  <row>⠀⠀⠀⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞</row>
                  <row>⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚⠀⠼⠁⠚</row>
                  <row>⠼⠁⠚⠀⠼⠁⠚</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠒⠒⠒⠀⠼⠁⠀⠗⠥⠝⠤⠑⠊⠝⠞⠗⠁⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀</row>
                </page>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠃</row>
                  <row>⠀⠀⠀⠀⠕⠗⠊⠛⠊⠝⠁⠇⠳⠃⠑⠗⠎⠉⠓⠗⠊⠋⠞</row>
                  <row>⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁⠀⠼⠁⠁</row>
                  <row>⠼⠁⠁⠀⠼⠁⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="underline-h3">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <level2>
                    <level3>
                      <h3>Level 3</h3>
                      <p>Bla bla bla</p>
                    </level3>
                  </level2>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="levels-in-footer" select="0"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/underline-h3/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/underline-h3/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠇⠑⠧⠑⠇⠀⠼⠉</row>
                  <row>⠂⠂⠂⠂⠂⠂⠂⠂</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="disable-hyphenation">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="file" href="../resources/test_downgrade_contracted_braille/test_downgrade_contracted_braille.xml"/>
      </x:input>
      <x:option name="contraction-grade" select="2"/>
      <x:option name="hyphenation" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/test_downgrade_contracted_braille/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/test_downgrade_contracted_braille/test_downgrade_contracted_braille.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="file" href="../resources/test_downgrade_contracted_braille/output_expected/test_downgrade_contracted_braille.pef"/>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="line-numbering-type-1">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <p>bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla</p>
                  <linegroup>
                    <line><linenum>5</linenum> Er wollte nur noch nach Hause. Dort</line>
                    <line>wartete bestimmt sein Vater auf</line>
                    <line>ihn. Alles war noch voller Blut. Später</line>
                    <line>wurde er etwas nachdenklich. Das Ganze</line>
                    <line>tat ihm plötzlich sehr leid.</line>
                    <line><linenum>10</linenum> Doch er musste nun die Leiche</line>
                    <line>beseitigen. Er hatte dies schon unzählige</line>
                    <line>Male getan. Und er wusste worauf es ankam.</line>
                    <line>Also machte er sich ans Werk. Er</line>
                    <line>durfte keine Zeit mehr verlieren.</line>
                    <line><linenum>15</linenum> Während er den Boden reinigte, öffnete</line>
                    <line>sich plötzlich die Tür. Ein Nachbar</line>
                    <line>hatte Lärm gehört und wollte nach</line>
                    <line>dem Rechten sehen. Er fragte sogar,</line>
                    <line>ob er behilflich sein könne.</line>
                    <line><linenum>20</linenum> Plötzlich ...</line>
                  </linegroup>
                  <p>bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla</p>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="include-brf" select="true()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/line-numbering-type-1/')"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/line-numbering-type-1/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/line-numbering-type-1/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
               <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠑⠀⠀⠑⠗⠀⠺⠕⠇⠇⠞⠑⠀⠝⠥⠗⠀⠝⠕⠉⠓⠀⠝⠁⠉⠓</row>
                  <row>⠀⠀⠀⠀⠀⠀⠓⠁⠥⠎⠑⠄⠀⠙⠕⠗⠞</row>
                  <row>⠀⠀⠀⠀⠺⠁⠗⠞⠑⠞⠑⠀⠃⠑⠎⠞⠊⠍⠍⠞⠀⠎⠑⠊⠝</row>
                  <row>⠀⠀⠀⠀⠀⠀⠧⠁⠞⠑⠗⠀⠁⠥⠋</row>
                  <row>⠀⠀⠀⠀⠊⠓⠝⠄⠀⠁⠇⠇⠑⠎⠀⠺⠁⠗⠀⠝⠕⠉⠓⠀⠧⠕⠇⠤</row>
                  <row>⠀⠀⠀⠀⠀⠀⠇⠑⠗⠀⠃⠇⠥⠞⠄⠀⠎⠏⠜⠞⠑⠗</row>
                  <row>⠀⠀⠀⠀⠺⠥⠗⠙⠑⠀⠑⠗⠀⠑⠞⠺⠁⠎⠀⠝⠁⠉⠓⠙⠑⠝⠅⠤</row>
                  <row>⠀⠀⠀⠀⠀⠀⠇⠊⠉⠓⠄⠀⠙⠁⠎⠀⠛⠁⠝⠵⠑</row>
                  <row>⠀⠀⠀⠀⠞⠁⠞⠀⠊⠓⠍⠀⠏⠇⠪⠞⠵⠇⠊⠉⠓⠀⠎⠑⠓⠗</row>
                  <row>⠀⠀⠀⠀⠀⠀⠇⠑⠊⠙⠄</row>
                  <row>⠁⠚⠀⠀⠙⠕⠉⠓⠀⠑⠗⠀⠍⠥⠎⠎⠞⠑⠀⠝⠥⠝⠀⠙⠊⠑</row>
                  <row>⠀⠀⠀⠀⠀⠀⠇⠑⠊⠉⠓⠑</row>
                  <row>⠀⠀⠀⠀⠃⠑⠎⠑⠊⠞⠊⠛⠑⠝⠄⠀⠑⠗⠀⠓⠁⠞⠞⠑</row>
                  <row>⠀⠀⠀⠀⠀⠀⠙⠊⠑⠎⠀⠎⠉⠓⠕⠝⠀⠥⠝⠵⠜⠓⠇⠊⠛⠑</row>
                  <row>⠀⠀⠀⠀⠍⠁⠇⠑⠀⠛⠑⠞⠁⠝⠄⠀⠥⠝⠙⠀⠑⠗⠀⠺⠥⠎⠎⠤</row>
                  <row>⠀⠀⠀⠀⠀⠀⠞⠑⠀⠺⠕⠗⠁⠥⠋⠀⠑⠎⠀⠁⠝⠅⠁⠍⠄</row>
                  <row>⠀⠀⠀⠀⠁⠇⠎⠕⠀⠍⠁⠉⠓⠞⠑⠀⠑⠗⠀⠎⠊⠉⠓⠀⠁⠝⠎</row>
                  <row>⠀⠀⠀⠀⠀⠀⠺⠑⠗⠅⠄⠀⠑⠗</row>
                  <row>⠀⠀⠀⠀⠙⠥⠗⠋⠞⠑⠀⠅⠑⠊⠝⠑⠀⠵⠑⠊⠞⠀⠍⠑⠓⠗</row>
                  <row>⠀⠀⠀⠀⠀⠀⠧⠑⠗⠇⠊⠑⠗⠑⠝⠄</row>
                  <row>⠁⠑⠀⠀⠺⠜⠓⠗⠑⠝⠙⠀⠑⠗⠀⠙⠑⠝⠀⠃⠕⠙⠑⠝</row>
                  <row>⠀⠀⠀⠀⠀⠀⠗⠑⠊⠝⠊⠛⠞⠑⠂⠀⠪⠋⠋⠝⠑⠞⠑</row>
                  <row>⠀⠀⠀⠀⠎⠊⠉⠓⠀⠏⠇⠪⠞⠵⠇⠊⠉⠓⠀⠙⠊⠑⠀⠞⠳⠗⠄</row>
                  <row>⠀⠀⠀⠀⠀⠀⠑⠊⠝⠀⠝⠁⠉⠓⠃⠁⠗</row>
                </page>
                <page>
                  <row>⠀⠀⠀⠀⠓⠁⠞⠞⠑⠀⠇⠜⠗⠍⠀⠛⠑⠓⠪⠗⠞⠀⠥⠝⠙</row>
                  <row>⠀⠀⠀⠀⠀⠀⠺⠕⠇⠇⠞⠑⠀⠝⠁⠉⠓</row>
                  <row>⠀⠀⠀⠀⠙⠑⠍⠀⠗⠑⠉⠓⠞⠑⠝⠀⠎⠑⠓⠑⠝⠄⠀⠑⠗</row>
                  <row>⠀⠀⠀⠀⠀⠀⠋⠗⠁⠛⠞⠑⠀⠎⠕⠛⠁⠗⠂</row>
                  <row>⠀⠀⠀⠀⠕⠃⠀⠑⠗⠀⠃⠑⠓⠊⠇⠋⠇⠊⠉⠓⠀⠎⠑⠊⠝</row>
                  <row>⠀⠀⠀⠀⠀⠀⠅⠪⠝⠝⠑⠄</row>
                  <row>⠃⠚⠀⠀⠏⠇⠪⠞⠵⠇⠊⠉⠓⠀⠄⠄⠄</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="line-numbering-type-2">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <p>bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla</p>
                  <p><span class="linenum">5</span> Er wollte nur noch nach Hause. Dort wartete bestimmt sein
                  Vater auf ihn.</p>
                  <p>Alles war noch voller Blut. Später wurde er etwas nachdenklich. Das Ganze tat ihm
                  plötzlich sehr leid. <span class="linenum">10</span> Doch er musste nun die Leiche
                  beseitigen. Er hatte dies schon unzählige Male getan. Und er wusste worauf es ankam. Also
                  machte er sich ans Werk. Er durfte keine Zeit mehr verlieren.</p>
                  <p class="precedingemptyline"><span class="linenum">15</span> Während er den Boden reinigte,
                  öffnete sich plötzlich die Tür. Ein Nachbar hatte Lärm gehört und wollte nach dem Rechten
                  sehen. Er fragte sogar, ob er behilflich sein könne.</p>
                  <p class="precedingemptyline"><span class="linenum">20</span> Plötzlich ...</p>
                  <p>bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla</p>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="include-brf" select="true()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/line-numbering-type-2/')"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/line-numbering-type-2/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/line-numbering-type-2/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠀⠑⠀⠀⠀⠀⠑⠗⠀⠺⠕⠇⠇⠞⠑⠀⠝⠥⠗⠀⠝⠕⠉⠓</row>
                  <row>⠀⠀⠀⠀⠝⠁⠉⠓⠀⠓⠁⠥⠎⠑⠄⠀⠙⠕⠗⠞⠀⠺⠁⠗⠞⠑⠞⠑</row>
                  <row>⠀⠀⠀⠀⠃⠑⠎⠞⠊⠍⠍⠞⠀⠎⠑⠊⠝⠀⠧⠁⠞⠑⠗⠀⠁⠥⠋</row>
                  <row>⠀⠀⠀⠀⠊⠓⠝⠄</row>
                  <row>⠀⠀⠀⠀⠀⠀⠁⠇⠇⠑⠎⠀⠺⠁⠗⠀⠝⠕⠉⠓⠀⠧⠕⠇⠇⠑⠗</row>
                  <row>⠀⠀⠀⠀⠃⠇⠥⠞⠄⠀⠎⠏⠜⠞⠑⠗⠀⠺⠥⠗⠙⠑⠀⠑⠗</row>
                  <row>⠀⠀⠀⠀⠑⠞⠺⠁⠎⠀⠝⠁⠉⠓⠙⠑⠝⠅⠇⠊⠉⠓⠄⠀⠙⠁⠎</row>
                  <row>⠀⠀⠀⠀⠛⠁⠝⠵⠑⠀⠞⠁⠞⠀⠊⠓⠍⠀⠏⠇⠪⠞⠵⠇⠊⠉⠓</row>
                  <row>⠀⠀⠀⠀⠎⠑⠓⠗⠀⠇⠑⠊⠙⠄</row>
                  <row>⠁⠚⠀⠀⠙⠕⠉⠓⠀⠑⠗⠀⠍⠥⠎⠎⠞⠑⠀⠝⠥⠝⠀⠙⠊⠑</row>
                  <row>⠀⠀⠀⠀⠇⠑⠊⠉⠓⠑⠀⠃⠑⠎⠑⠊⠞⠊⠛⠑⠝⠄⠀⠑⠗</row>
                  <row>⠀⠀⠀⠀⠓⠁⠞⠞⠑⠀⠙⠊⠑⠎⠀⠎⠉⠓⠕⠝⠀⠥⠝⠵⠜⠓⠤</row>
                  <row>⠀⠀⠀⠀⠇⠊⠛⠑⠀⠍⠁⠇⠑⠀⠛⠑⠞⠁⠝⠄⠀⠥⠝⠙⠀⠑⠗</row>
                  <row>⠀⠀⠀⠀⠺⠥⠎⠎⠞⠑⠀⠺⠕⠗⠁⠥⠋⠀⠑⠎⠀⠁⠝⠅⠁⠍⠄</row>
                  <row>⠀⠀⠀⠀⠁⠇⠎⠕⠀⠍⠁⠉⠓⠞⠑⠀⠑⠗⠀⠎⠊⠉⠓⠀⠁⠝⠎</row>
                  <row>⠀⠀⠀⠀⠺⠑⠗⠅⠄⠀⠑⠗⠀⠙⠥⠗⠋⠞⠑⠀⠅⠑⠊⠝⠑</row>
                  <row>⠀⠀⠀⠀⠵⠑⠊⠞⠀⠍⠑⠓⠗⠀⠧⠑⠗⠇⠊⠑⠗⠑⠝⠄</row>
                  <row/>
                  <row>⠁⠑⠀⠀⠀⠀⠺⠜⠓⠗⠑⠝⠙⠀⠑⠗⠀⠙⠑⠝⠀⠃⠕⠙⠑⠝</row>
                  <row>⠀⠀⠀⠀⠗⠑⠊⠝⠊⠛⠞⠑⠂⠀⠪⠋⠋⠝⠑⠞⠑⠀⠎⠊⠉⠓</row>
                  <row>⠀⠀⠀⠀⠏⠇⠪⠞⠵⠇⠊⠉⠓⠀⠙⠊⠑⠀⠞⠳⠗⠄⠀⠑⠊⠝</row>
                  <row>⠀⠀⠀⠀⠝⠁⠉⠓⠃⠁⠗⠀⠓⠁⠞⠞⠑⠀⠇⠜⠗⠍⠀⠛⠑⠤</row>
                  <row>⠀⠀⠀⠀⠓⠪⠗⠞⠀⠥⠝⠙⠀⠺⠕⠇⠇⠞⠑⠀⠝⠁⠉⠓⠀⠙⠑⠍</row>
                  <row>⠀⠀⠀⠀⠗⠑⠉⠓⠞⠑⠝⠀⠎⠑⠓⠑⠝⠄⠀⠑⠗⠀⠋⠗⠁⠛⠞⠑</row>
                </page>
                <page>
                  <row>⠀⠀⠀⠀⠎⠕⠛⠁⠗⠂⠀⠕⠃⠀⠑⠗⠀⠃⠑⠓⠊⠇⠋⠇⠊⠉⠓</row>
                  <row>⠀⠀⠀⠀⠎⠑⠊⠝⠀⠅⠪⠝⠝⠑⠄</row>
                  <row/>
                  <row>⠃⠚⠀⠀⠀⠀⠏⠇⠪⠞⠵⠇⠊⠉⠓⠀⠄⠄⠄</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                  <row>⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="pageref">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <frontmatter>
                <level1>
                  <p>...</p>
                  <p>Zeichnungen ab Seite <a class="pageref" href="#p-81">81</a></p>
                  <p>...</p>
                  <p><a class="pageref" href="#p-81">82</a></p>
                </level1>
              </frontmatter>
              <bodymatter>
                <level1>
                  <p>...</p>
                  <pagenum id="page-81" page="normal">81</pagenum>
                  <a id="p-81"/>
                  <level2>
                    <h2>Die Heilmittel</h2>
                    <p>
                      ...
                      <pagenum id="page-82" page="normal">82</pagenum>
                      <a id="p-82"/>
                      ...
                    </p>
                  </level2>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="show-braille-page-numbers" select="true()"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="levels-in-footer" select="0"/>
      <x:option name="include-brf" select="true()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/pageref/')"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/pageref/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/pageref/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠀⠀⠄⠄⠄</row>
                  <row>⠀⠀⠵⠑⠊⠉⠓⠝⠥⠝⠛⠑⠝⠀⠁⠃⠀⠎⠑⠊⠞⠑⠀⠼⠁</row>
                  <row>⠀⠀⠄⠄⠄</row>
                  <row>⠀⠀⠼⠁</row>
                </page>
              </section>
              <section>
                <page>
                  <row>⠀⠀⠄⠄⠄</row>
                  <row/>
                  <row/>
                  <row>⠙⠊⠑⠀⠓⠑⠊⠇⠍⠊⠞⠞⠑⠇</row>
                  <row>⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                  <row>⠀⠀⠄⠄⠄⠀⠄⠄⠄</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠼⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="bug-61-repeated-text">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xmlns="http://www.daisy.org/z3986/2005/dtbook/" xml:lang="de">
            <head/>
            <book>
              <bodymatter>
                <level1>
                  <p>Neben ihm stand eine junge Frau, die hingerissen auf die elektrischen Kerzen starrte. Im
                  nächsten Augenblick drehte sie sich nach einem kleinen Jungen um, der dicht hinter ihr
                  stand, dabei stieß sie Eleusius mit ihrem Ellbogen an. »Verzeihung«, sagte sie. Sie
                  strahlte ihn an, ihr rötliches Haar glich dem himmlischen Abendrot. Der Engel riss sich
                  nur ungern vom Anblick der lächelnden <pagenum id="page-16" page="normal">16</pagenum>
                  Frau los. Als er sich einen Weg durch die Menge bahnte, achtete er darauf, nicht plötzlich
                  zu schweben.</p>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="2"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="show-print-page-numbers" select="true()"/>
      <x:option name="levels-in-footer" select="0"/>
      <x:option name="include-brf" select="true()"/>
      <x:param port="parameters" name="generate-titlepage" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/bug-61-repeated-text/')"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/bug-61-repeated-text/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/bug-61-repeated-text/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠀⠀⠝⠃⠀⠦⠀⠂⠾⠀⠫⠑⠀⠚⠲⠯⠀⠋⠗⠡⠂⠀⠬⠀⠓⠔⠯⠤</row>
                  <row>⠗⠊⠮⠉⠀⠡⠀⠬⠀⠽⠑⠅⠞⠗⠊⠱⠉⠀⠅⠻⠵⠉⠀⠾⠴⠗⠦⠄</row>
                  <row>⠤⠀⠝⠾⠉⠀⠡⠛⠉⠃⠇⠊⠨⠀⠙⠗⠶⠦⠀⠎⠀⠉⠀⠝⠰⠀⠫⠷</row>
                  <row>⠅⠇⠫⠉⠀⠚⠲⠛⠉⠀⠥⠍⠂⠀⠗⠀⠙⠼⠞⠀⠓⠔⠞⠻⠀⠊</row>
                  <row>⠂⠾⠂⠀⠙⠃⠀⠾⠬⠠⠮⠀⠎⠀⠽⠣⠎⠊⠥⠎⠀⠞⠀⠊⠷</row>
                  <row>⠑⠟⠃⠕⠛⠉⠀⠖⠄⠀⠦⠤⠵⠩⠓⠥⠴⠂⠀⠎⠛⠦⠀⠎⠄⠀⠎</row>
                  <row>⠾⠗⠁⠓⠇⠦⠀⠊⠓⠀⠖⠂⠀⠊⠀⠗⠪⠞⠸⠿⠀⠓⠁⠁⠗⠀⠛⠸</row>
                  <row>⠷⠀⠓⠊⠭⠇⠊⠱⠉⠀⠁⠃⠉⠙⠗⠕⠞⠄⠀⠗⠀⠉⠛⠽⠀⠗⠊⠮</row>
                  <row>⠉⠀⠝⠗⠀⠲⠛⠻⠝⠀⠧⠍⠀⠖⠃⠇⠊⠨⠀⠗⠀⠇⠜⠹⠽⠝⠙⠉</row>
                  <row>⠋⠗⠡⠀⠇⠕⠎⠄⠀⠩⠀⠻⠀⠉⠀⠫⠉⠀⠺⠛⠀⠹⠀⠬⠀⠍⠉⠯</row>
                  <row>⠃⠁⠓⠝⠦⠂⠀⠁⠹⠦⠦⠀⠻⠀⠙⠡⠂⠀⠝⠀⠏⠸⠀⠵</row>
                  <row>⠱⠺⠑⠃⠉⠄</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠸⠼⠁⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="titlepage-docauthor-doctitle">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <frontmatter>
                <doctitle>Titel</doctitle>
                <docauthor>Autor</docauthor>
                <level1 class="titlepage">
                  <level2>
                    <p>Titelseite</p>
                  </level2>
                </level1>
                <level1>
                  <p>bla</p>
                </level1>
              </frontmatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="include-brf" select="true()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/titlepage-docauthor-doctitle/')"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/titlepage-docauthor-doctitle/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/titlepage-docauthor-doctitle/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠥⠞⠕⠗</row>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠞⠊⠞⠑⠇</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠀⠀⠘⠎⠃⠎⠀⠎⠉⠓⠺⠑⠊⠵⠄⠀⠃⠊⠃⠇⠊⠕⠞⠓⠑⠅</row>
                  <row>⠀⠀⠀⠀⠋⠳⠗⠀⠃⠇⠊⠝⠙⠑⠂⠀⠎⠑⠓⠤⠀⠥⠝⠙</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠇⠑⠎⠑⠃⠑⠓⠊⠝⠙⠑⠗⠞⠑</row>
                </page>
                <page>
                  <row/>
                  <row>⠙⠊⠑⠎⠑⠎⠀⠃⠗⠁⠊⠇⠇⠑⠃⠥⠉⠓⠀⠊⠎⠞⠀⠙⠊⠑</row>
                  <row>⠁⠥⠎⠎⠉⠓⠇⠊⠑⠮⠇⠊⠉⠓⠀⠋⠳⠗⠀⠙⠊⠑⠀⠝⠥⠞⠤</row>
                  <row>⠵⠥⠝⠛⠀⠙⠥⠗⠉⠓⠀⠎⠑⠓⠤⠀⠥⠝⠙⠀⠇⠑⠎⠑⠃⠑⠤</row>
                  <row>⠓⠊⠝⠙⠑⠗⠞⠑⠀⠍⠑⠝⠎⠉⠓⠑⠝⠀⠃⠑⠎⠞⠊⠍⠍⠞⠑</row>
                  <row>⠵⠥⠛⠜⠝⠛⠇⠊⠉⠓⠑⠀⠧⠑⠗⠎⠊⠕⠝⠀⠑⠊⠝⠑⠎</row>
                  <row>⠥⠗⠓⠑⠃⠑⠗⠗⠑⠉⠓⠞⠇⠊⠉⠓⠀⠛⠑⠎⠉⠓⠳⠞⠵⠞⠑⠝</row>
                  <row>⠺⠑⠗⠅⠎⠄⠀⠨⠎⠊⠑⠀⠅⠪⠝⠝⠑⠝⠀⠑⠎⠀⠊⠍</row>
                  <row>⠗⠁⠓⠍⠑⠝⠀⠙⠑⠎⠀⠥⠗⠓⠑⠃⠑⠗⠗⠑⠉⠓⠞⠎</row>
                  <row>⠏⠑⠗⠎⠪⠝⠇⠊⠉⠓⠀⠝⠥⠞⠵⠑⠝⠂⠀⠙⠳⠗⠋⠑⠝⠀⠑⠎</row>
                  <row>⠁⠃⠑⠗⠀⠝⠊⠉⠓⠞⠀⠺⠑⠊⠞⠑⠗⠀⠧⠑⠗⠃⠗⠑⠊⠞⠑⠝</row>
                  <row>⠕⠙⠑⠗⠀⠪⠋⠋⠑⠝⠞⠇⠊⠉⠓⠀⠵⠥⠛⠜⠝⠛⠇⠊⠉⠓</row>
                  <row>⠍⠁⠉⠓⠑⠝⠄</row>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠧⠑⠗⠇⠁⠛⠂⠀⠎⠁⠞⠵⠀⠥⠝⠙⠀⠙⠗⠥⠉⠅</row>
                  <row>⠘⠎⠃⠎⠀⠎⠉⠓⠺⠑⠊⠵⠄⠀⠃⠊⠃⠇⠊⠕⠞⠓⠑⠅</row>
                  <row>⠋⠳⠗⠀⠃⠇⠊⠝⠙⠑⠂⠀⠎⠑⠓⠤⠀⠥⠝⠙</row>
                  <row>⠇⠑⠎⠑⠃⠑⠓⠊⠝⠙⠑⠗⠞⠑⠂⠀⠵⠳⠗⠊⠉⠓</row>
                  <row>⠠⠨⠺⠺⠺⠄⠎⠃⠎⠄⠉⠓</row>
                  <row/>
                  <row>⠘⠎⠃⠎⠀</row>
                </page>
              </section>
              <section>
                <page>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠥⠞⠕⠗</row>
                  <row/>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠞⠊⠞⠑⠇</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠞⠊⠞⠑⠇⠎⠑⠊⠞⠑</row>
                </page>
              </section>
              <section>
                <page>
                  <row>⠀⠀⠃⠇⠁</row>
                </page>
              </section>
              <section>
                <page/>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="bug-64-skip-margin-top-of-page-after-volume-break">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xmlns="http://www.daisy.org/z3986/2005/dtbook/"
                  xmlns:brl="http://www.daisy.org/z3986/2009/braille/"
                  version="2005-3-sbs-full" xml:lang="de">
            <book>
              <bodymatter>
                <level1>
                  <level2>
                    <pagenum id="page-73" page="normal">73</pagenum>
                    <h2>Kapitel 1</h2>
                    <p>bla bla bla</p>
                  </level2>
                  <brl:volume brl:grade="0"/>
                  <brl:volume brl:grade="1"/>
                  <brl:volume brl:grade="2"/>
                  <level2>
                    <pagenum id="page-74" page="normal">74</pagenum>
                    <h2>Kapitel 2</h2>
                    <p>bla bla bla</p>
                  </level2>
                  <brl:volume brl:grade="0"/>
                  <brl:volume brl:grade="1"/>
                  <brl:volume brl:grade="2"/>
                  <level2>
                    <pagenum id="page-75" page="normal">75</pagenum>
                    <h2>Kapitel 3</h2>
                    <p>bla bla bla</p>
                  </level2>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="include-brf" select="true()"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="levels-in-footer" select="0"/>
      <x:param port="parameters" name="generate-titlepage" select="false()"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/bug-64-skip-margin-top-of-page-after-volume-break/')"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/bug-64-skip-margin-top-of-page-after-volume-break/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/bug-64-skip-margin-top-of-page-after-volume-break/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠅⠁⠏⠊⠞⠑⠇⠀⠼⠁</row>
                  <row>⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                </page>
              </section>
            </volume>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠅⠁⠏⠊⠞⠑⠇⠀⠼⠃</row>
                  <row>⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                </page>
              </section>
            </volume>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠅⠁⠏⠊⠞⠑⠇⠀⠼⠉</row>
                  <row>⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒</row>
                  <row>⠀⠀⠃⠇⠁⠀⠃⠇⠁⠀⠃⠇⠁</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="definition-list">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <dl>
                    <dt>DT DT DT DT</dt>
                    <dd>DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD
                        DD DD DD DD DD DD DD DD DD DD DD.</dd>
                    <dt>DT DT DT DT</dt>
                    <dd>DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD
                        DD DD DD DD DD DD DD DD DD DD DD.</dd>
                    <dt>DT DT DT DT</dt>
                    <dd>DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD
                        DD DD DD DD DD DD DD DD DD DD DD.</dd>
                    <dt>DT DT DT DT</dt>
                    <dd>DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1 DD1
                        DD1 DD1 DD1 DD1 DD1 DD1 DD1.</dd>
                    <dd>DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2 DD2
                        DD2 DD2.</dd>
                    <dd>DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3
                        DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3 DD3.</dd>
                    <dt>DT1 DT1</dt>
                    <dt>DT2 DT2</dt>
                    <dd>DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD
                        DD DD DD DD DD DD DD DD DD.</dd>
                  </dl>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="0"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="levels-in-footer" select="0"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/definition-list/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/definition-list/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row>⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠄</row>
                  <row>⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠄</row>
                  <row>⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠄</row>
                  <row>⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠞⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁</row>
                  <row>⠀⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁</row>
                  <row>⠀⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁</row>
                  <row>⠀⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁</row>
                  <row>⠀⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁</row>
                  <row>⠀⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠀⠙⠙⠼⠁⠄</row>
                  <row>⠀⠀⠀⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃</row>
                  <row>⠀⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃</row>
                  <row>⠀⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃</row>
                  <row>⠀⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃⠀⠙⠙⠼⠃</row>
                  <row>⠀⠀⠙⠙⠼⠃⠄</row>
                  <row>⠀⠀⠀⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉</row>
                  <row>⠀⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉</row>
                </page>
                <page>
                  <row>⠀⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉</row>
                  <row>⠀⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉</row>
                  <row>⠀⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉</row>
                  <row>⠀⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠀⠙⠙⠼⠉⠄</row>
                  <row>⠙⠞⠼⠁⠀⠙⠞⠼⠁⠀⠙⠞⠼⠃⠀⠙⠞⠼⠃⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙</row>
                  <row>⠀⠀⠙⠙⠀⠙⠙⠀⠙⠙⠀⠙⠙⠄</row>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>

  <x:scenario label="definition-list-2">
    <x:call step="sbs:dtbook-to-pef">
      <x:input port="source">
        <x:document type="inline">
          <dtbook xml:lang="de" xmlns="http://www.daisy.org/z3986/2005/dtbook/">
            <book>
              <bodymatter>
                <level1>
                  <h1>Definitionslisten</h1>
                  <dl>
                    <dt>Auto:</dt>
                    <dd>bezinbetriebenes Fahrzeug.</dd>
                    <dt>Chamäleon:</dt>
                    <dd>lustiges Tier, welches seine Farbe der Umgebung anzupassen vermag.</dd>
                    <dt><abbr>ZZ</abbr> Top:</dt>
                    <dd><abbr>US</abbr>-amerikanische Blues-Rockband.</dd>
                    <dt>Longmire:</dt>
                    <dd>Diese amerikanische Crime-Serie basiert auf den Bestsellern von Craig Johnson und
                    fühlt sich an wie ein zeitgenössischer Western, nur kälter und mysteriöser.</dd>
                    <dt>Mozart in the Jungle:</dt>
                    <dd>Die Serie basiert auf den Memoiren <em>Mozart in the Jungle: Sex, Drugs, and Classical
                    Music</em> von der US-amerikanischen Oboistin Blair Tindall, in denen die Autorin ihre
                    Erfahrungen bei den New Yorker Philharmonikern niedergeschrieben hat.</dd>
                  </dl>
                </level1>
              </bodymatter>
            </book>
          </dtbook>
        </x:document>
      </x:input>
      <x:option name="contraction-grade" select="2"/>
      <x:option name="show-print-page-numbers" select="false()"/>
      <x:option name="show-braille-page-numbers" select="false()"/>
      <x:option name="levels-in-footer" select="0"/>
      <x:option name="pef-output-dir" select="concat($temp-dir,'output-dir/definition-list-2/')"/>
      <x:option name="include-brf" select="true()"/>
      <x:option name="brf-output-dir" select="concat($temp-dir,'output-dir/definition-list-2/')"/>
      <x:option name="temp-dir" select="concat($temp-dir,'temp-dir/')"/>
    </x:call>
    <x:context label="result">
      <x:document type="file" base-uri="temp-dir" href="output-dir/definition-list-2/test_dtbook-to-pef.pef"/>
    </x:context>
    <x:expect label="result" type="custom" href="http://www.daisy.org/pipeline/modules/braille/pef-utils/library.xpl" step="x:pef-compare">
      <x:document type="inline">
        <pef xmlns="http://www.daisy.org/ns/2008/pef" version="2008-1">
          <head>
            <meta xmlns:dc="http://purl.org/dc/elements/1.1/">
              <dc:format>application/x-pef+xml</dc:format>
              <dc:language>de</dc:language>
            </meta>
          </head>
          <body>
            <volume cols="28" rows="28" rowgap="0" duplex="true">
              <section>
                <page>
                  <row/>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠙⠑⠋⠔⠊⠞⠚⠎⠇⠊⠾⠉</row>
                  <row>⠀⠀⠀⠀⠀⠀⠀⠀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤</row>
                  <row/>
                  <row>⠡⠞⠕⠒⠀⠆⠵⠔⠆⠞⠗⠬⠃⠉⠿⠀⠂⠗⠵⠣⠛⠄</row>
                  <row>⠹⠁⠍⠜⠇⠑⠕⠝⠒⠀⠇⠥⠾⠘⠿⠀⠞⠬⠗⠂⠀⠽⠿⠀⠪⠑</row>
                  <row>⠀⠀⠋⠴⠃⠑⠀⠗⠀⠥⠍⠯⠃⠥⠀⠖⠂⠵⠏⠁⠮⠉⠀⠤⠍⠁⠛⠄</row>
                  <row>⠘⠵⠵⠀⠞⠕⠏⠒⠀⠘⠥⠎⠤⠁⠍⠻⠊⠅⠖⠊⠱⠑</row>
                  <row>⠀⠀⠃⠇⠥⠑⠎⠤⠗⠕⠨⠃⠖⠙⠄</row>
                  <row>⠇⠕⠝⠛⠍⠗⠑⠒⠀⠬⠑⠀⠁⠍⠻⠊⠅⠖⠊⠱⠑⠀⠠⠉⠗⠊⠤</row>
                  <row>⠀⠀⠍⠑⠤⠎⠻⠊⠑⠀⠃⠁⠎⠬⠗⠞⠀⠡⠀⠑⠀⠆⠾⠎⠑⠟⠻⠝</row>
                  <row>⠀⠀⠧⠀⠠⠉⠗⠁⠊⠛⠀⠚⠕⠓⠝⠎⠕⠝⠀⠥⠀⠋⠳⠓⠇⠞⠀⠉</row>
                  <row>⠀⠀⠖⠀⠣⠀⠫⠀⠵⠞⠯⠝⠪⠮⠊⠱⠻⠀⠺⠑⠾⠻⠝⠂⠀⠝⠗</row>
                  <row>⠀⠀⠅⠜⠇⠞⠻⠀⠥⠀⠍⠠⠽⠾⠻⠊⠪⠎⠻⠄</row>
                  <row>⠍⠕⠵⠴⠞⠀⠔⠀⠞⠓⠑⠀⠚⠲⠛⠇⠑⠒⠀⠬⠀⠎⠻⠊⠑</row>
                  <row>⠀⠀⠃⠁⠎⠬⠗⠞⠀⠡⠀⠑⠀⠍⠷⠕⠊⠗⠉⠀⠸⠸⠍⠕⠵⠴⠞</row>
                  <row>⠀⠀⠔⠀⠞⠓⠑⠀⠚⠲⠛⠇⠑⠒⠀⠎⠑⠠⠭⠂⠀⠙⠗⠥⠛⠎⠂</row>
                  <row>⠀⠀⠖⠙⠀⠠⠉⠇⠁⠮⠊⠠⠉⠁⠇⠀⠍⠥⠎⠊⠠⠉⠠⠄⠀⠧⠀⠗</row>
                  <row>⠀⠀⠥⠎⠤⠁⠍⠻⠊⠅⠖⠊⠱⠉⠀⠕⠃⠕⠊⠾⠔⠀⠃⠇⠁⠊⠗</row>
                  <row>⠀⠀⠞⠔⠙⠁⠟⠂⠀⠔⠀⠑⠉⠀⠬⠀⠡⠞⠢⠔⠀⠊⠑⠀⠻⠤</row>
                  <row>⠀⠀⠂⠗⠥⠉⠀⠃⠀⠑⠀⠝⠑⠺⠀⠠⠽⠢⠅⠻⠀⠏⠓⠊⠇⠓⠴⠤</row>
                  <row>⠀⠀⠍⠕⠝⠊⠅⠻⠝⠀⠝⠬⠙⠻⠯⠂⠱⠉⠀⠓⠞⠄</row>
                  <row/>
                </page>
              </section>
            </volume>
          </body>
        </pef>
      </x:document>
    </x:expect>
  </x:scenario>
  
</x:description>
